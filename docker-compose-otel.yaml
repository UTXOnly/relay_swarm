
services:
  opentelemetry-collector:
    image: otel/opentelemetry-collector-contrib:latest
    #build: .
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /proc/:/host/proc/:ro
      - /sys/fs/cgroup:/host/sys/fs/cgroup:ro
      - /sys/kernel/debug:/sys/kernel/debug
      - ./config-opentelemetry.yaml:/etc/otel/config.yaml
    ports:
      - "55680:55680"
      - "4317:4317"
      - "4318:4318"
    #networks:
    #  - my-overlay-network
    command: ["--config=/etc/otel/config.yaml"]
    deploy:
      mode: global
      resources:
        limits:
          cpus: '0.5'
          memory: 350M
        reservations:
          cpus: '0.25'
          memory: 250M
    #configs:
    #  - source: opentelemetry-config
    #    target: /etc/otel/config.yaml

#networks:
#  my-overlay-network:
#    driver: overlay
#    attachable: true
#    external: true

#configs:
#  opentelemetry-config:
#    external: true
